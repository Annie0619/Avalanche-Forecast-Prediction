"0",""
"0","# average long and lat in the area:"
"0","mean_coord <- aval %>%"
"0","  filter(Area == ""Creag Meagaidh"") %>%"
"0","  summarise("
"0","    mean_lon = mean(longitude, na.rm = TRUE),"
"0","    mean_lat = mean(latitude, na.rm = TRUE)"
"0","  )"
"0",""
"0","# known bad coordinates (round to avoid float mismatch)"
"0","bad_lon <- round(as.numeric(zero_pts$x), 6)"
"0","bad_lat <- round(as.numeric(zero_pts$y), 6)"
"0",""
"0","# replacement mean values"
"0","mean_lon <- mean_coord$mean_lon"
"0","mean_lat <- mean_coord$mean_lat"
"0",""
"0","# replace in aval"
"0","aval <- aval %>%"
"0","  mutate("
"0","    longitude = if_else(round(longitude, 6) == bad_lon & round(latitude, 6) == bad_lat,"
"0","                        mean_lon, longitude),"
"0","    latitude  = if_else(round(longitude, 6) == bad_lon & round(latitude, 6) == bad_lat,"
"0","                        mean_lat, latitude)"
"0","  )"
