"0","# clean the data by casting variables as correct types"
"0","# STEP 1 â€” Fix types & engineer helper features (with OAH removed)"
"0",""
"0","aval <- aval %>%"
"0","  mutate("
"0","    # --- time features ---"
"0","    DateTime = ymd_hms(Date, quiet = TRUE),"
"0","    # strip out year, month and day:"
"0","    Date     = as.Date(DateTime),"
"0","    year     = year(Date),"
"0","    month    = month(Date),"
"0","    doy      = yday(Date),"
"0","    # create a new variable: season"
"0","    season   = factor(case_when("
"0","      month %in% c(12,1,2) ~ ""DJF"","
"0","      month %in% c(3,4,5)  ~ ""MAM"","
"0","      month %in% c(6,7,8)  ~ ""JJA"","
"0","      TRUE                 ~ ""SON"""
"0","    ), levels = c(""DJF"",""MAM"",""JJA"",""SON"")),"
"0",""
"0","    # --- categorical / IDs ---"
"0","    Area     = factor(Area),"
"0","    OSgrid   = as.character(OSgrid),"
"0","    Location = as.character(Location),"
"0","    Obs      = factor(Obs),"
"0","    Drift = factor(Drift),"
"0","    Rain.at.900 = factor(Rain.at.900),"
"0",""
"0","    # --- hazard (target) as ordered factor ---"
"0","    FAH_ord  = factor("
"0","      FAH,"
"0","      # specify the following order:"
"0","      levels  = c(""Low"",""Moderate"",""Considerable -"",""Considerable +"",""High""),"
"0","      ordered = TRUE"
"0","    )"
"0","  )"
